/* vote.uncompressed.js Compressed file. using UglifyJS. */
$(document).ready(function(){var e=$("#vote-base-url");var t="";if(e.length>0){t=e.val()}if($(".controller-messages").length&&$("#vote").length){var n=$("<div></div>").css({clear:"right"});var r=[];$(".message").each(function(){r.push($(this))});var i=function(){if(r.length){s(r.shift())}};var s=function(e){var n=$.Deferred();var r=e.attr("id");var s=$("#vote").clone().show().attr({id:null});if(r){s.data({topic:parseInt(String(r).replace(/message-/gi,""))})}e.css({clear:"both"}).prepend(s);var o=s.data("board");var u=s.data("topic");var a=s.find(".vote-point:first");$.ajax({type:"GET",url:t+"boards/"+o+"/topics/"+u+"/vote",cache:false,error:function(e,t,n){a.html("-")},success:function(e,t,n){a.html($(e).find("#vote-point").html())}}).always(function(){n.always();s.find(".vote-button").bind("click",function(e){e.preventDefault();var n=$(this).data("point");$.ajax({type:"POST",url:t+"boards/"+o+"/topics/"+u+"/vote",data:{point:n},cache:false,success:function(e,t,n){a.html($(e).find("#vote-point").html())}})});i()});return n.promise()};i()}var o=/https?:\/\/.*\/projects\/.*\/boards\/([0-9]*)/;var u=document.URL;var a=u.match(o);var f="#vote-result";if(a){$("<div></div>").attr("id","vote-result-box").insertAfter($("#content").find("p.breadcrumb"));$.ajax({type:"GET",url:t+"boards/"+a[1]+"/vote/result",cache:false,success:function(e,t,n){if($(f).length===0){var r=$(e).find(f).html();if(r){$("#vote-result-box").addClass("vote-result").html(r)}else{$("#vote-result-box").remove()}}}});var l=$("table.list.messages");$("<th></th>").html($("#label_vote_count").text()).insertAfter(l.find("thead > tr > th:nth-child(3)"));$("<td></td>").addClass("vote-td-trigger").insertAfter(l.find("tbody > tr > td:nth-child(3)"));$("td.vote-td-trigger").each(function(){var e=/\/boards\/([0-9]*)\/topics\/([0-9]*)/;var n=$(this).parent().find("td.subject > a").attr("href");var r=n.match(e);if(r){var i=r[1];var s=r[2];var o=$(this);$.ajax({type:"GET",url:t+"boards/"+i+"/topics/"+s+"/vote",cache:false,success:function(e,t,n){o.html($(e).find("#vote-point").html())}})}})}})